. 
. use $data, clear
. 
.         * Generate non urbanised area variables
.         gen l_ln_km_IHNU_83  = ln(ln_km_IH_83 - ln_km_IHU_83)
(50 missing values generated)
.         gen l_rd_km_IHNU_83  = ln(rd_km_IH_83 - rd_km_IHU_83)
(50 missing values generated)
.         gen l_vmt_IHNU_83 = ln(vmt_IH_83 - vmt_IHU_83)
(50 missing values generated)
.         gen l_aadt_IHNU_83 = l_vmt_IHNU_83 - l_rd_km_IHNU_83 
(50 missing values generated)
.         gen l_ln_km_IHNU_93  = ln(ln_km_IH_93 - ln_km_IHU_93)
(39 missing values generated)
.         gen l_rd_km_IHNU_93  = ln(rd_km_IH_93 - rd_km_IHU_93)
(39 missing values generated)
.         gen l_vmt_IHNU_93 = ln(vmt_IH_93 - vmt_IHU_93)
(39 missing values generated)
.         gen l_aadt_IHNU_93 = l_vmt_IHNU_93 - l_rd_km_IHNU_93 
(39 missing values generated)
.         gen l_ln_km_IHNU_03  = ln(ln_km_IH_03 - ln_km_IHU_03)
(38 missing values generated)
.         gen l_rd_km_IHNU_03  = ln(rd_km_IH_03 - rd_km_IHU_03)
(38 missing values generated)
.         gen l_vmt_IHNU_03 = ln(vmt_IH_03 - vmt_IHU_03)
(38 missing values generated)
.         gen l_aadt_IHNU_03 = l_vmt_IHNU_03 - l_rd_km_IHNU_03 
(38 missing values generated)
. 
.         * Selection of observations
.         drop if l_ln_km_IH_83==0
(47 observations deleted)
.         gen zero = min(l_ln_km_IH_83,l_ln_km_IH_93,l_ln_km_IHU_83,l_ln_km_IHU_93,l_ln_km_MRU_83,l_ln_km_MRU_93,l_ln_km_IHNU_83,l_ln_km_IHNU
> _93)
. 
.         rename sprawl_1992 sprawl_2003
.         rename sprawl_1976 sprawl_1993
. 
.         *rescale so display is better
.         replace elevat_range_msa = elevat_range_msa/1000 
variable elevat_range_msa was int now float
(228 real changes made)
.         replace ruggedness_msa = ruggedness_msa/1000
(228 real changes made)
.         replace heating_dd = heating_dd/100
(228 real changes made)
.         replace cooling_dd = cooling_dd/100
(228 real changes made)
. 
.         *Generate first differences
.         gen  Dl_ln_IH_1993 = l_ln_km_IH_93 - l_ln_km_IH_83
.         gen  Dl_ln_IH_2003 = l_ln_km_IH_03 - l_ln_km_IH_93
.         gen  Dl_vmt_IH_1993 = l_vmt_IH_93 - l_vmt_IH_83 
.         gen  Dl_vmt_IH_2003 = l_vmt_IH_03 - l_vmt_IH_93 
.         gen  Dl_aadt_IH_1993 = l_aadt_IH_93 - l_aadt_IH_83 
.         gen  Dl_aadt_IH_2003 = l_aadt_IH_03 - l_aadt_IH_93 
. 
. 
.         gen Dl_pop_1993 = l_pop90 -l_pop80
.         gen Dl_pop_2003 = l_pop00 -l_pop90
. 
.       gen l_pop_1983 = l_pop80 
.       gen l_pop_1993 = l_pop90 
.       gen l_pop_2003 = l_pop00 
.      
.         gen g_exp_2003=g_exp00_90
.         gen g_exp_1993=g_exp90_80
. 
.       rename l_aadt_IH_83 l_aadt_IH_1993
.       rename l_aadt_IH_93 l_aadt_IH_2003
.  
.         rename S_somecollege_80 S_somecollege_1993 
.         rename l_mean_income_80 l_mean_income_1993 
.         rename S_poor_80 S_poor_1993 
.         rename S_manuf83 S_manuf_1993 
.  
.         rename S_somecollege_90 S_somecollege_2003 
.         rename l_mean_income_90 l_mean_income_2003 
.         rename S_poor_90 S_poor_2003 
.         rename S_manuf93 S_manuf_2003 
. 
.         reshape long Dl_ln_IH Dl_aadt_IH l_aadt_IH 
option i() required

         long                                wide
        +---------------+                   +------------------+
        | i   j   a   b |                   | i   a1 a2  b1 b2 |
        |---------------| <--- reshape ---> |------------------|
        | 1   1   1   2 |                   | 1   1   3   2  4 |
        | 1   2   3   4 |                   | 2   5   7   6  8 |
        | 2   1   5   6 |                   +------------------+
        | 2   2   7   8 |
        +---------------+

        long to wide: reshape wide a b, i(i) j(j)    (j existing variable)
        wide to long: reshape long a b, i(i) j(j)    (j    new   variable)
r(198);
.                  sprawl S_somecollege l_mean_income S_poor S_manuf g_exp
.                          Dl_pop l_pop, i(msa ) j(year _1993 _2003)
. 
.         local geography  "elevat_range_msa ruggedness_msa heating_dd cooling_dd sprawl"
.         local demographics  "S_somecollege l_mean_income seg1980_ghetto S_poor S_manuf"  
.         local population "l_pop80 l_pop70 l_pop60 l_pop50 l_pop40 l_pop30 l_pop20"  
.         local census_div "div1 div2 div3 div4 div5 div6 div7 div8 div9"
. 
.         *instructions for outreg
.         local instruct "tex tdec(2) rdec(2) auto(2) symbol($^a$,$^b$,$^c$) se " 
.         local instruct2 "tex tdec(2) rdec(2) auto(2) symbol($^a$,$^b$,$^c$) se addstat(Overid, e(widstat))" 
. 
.         iis msa
. 
.         local R "IH"
. 
.         capture drop Dl_aadt Dl_ln l_aadt 
.         gen Dl_aadt = Dl_aadt_`R' 
.         gen Dl_ln  = Dl_ln_`R' 
.         gen l_aadt = l_aadt_`R' 
. 
.         xi: reg    Dl_aadt l_aadt i.year, cl(msa) robust  
.         outreg2    l_aadt using revision/table7.xls,ctitle(OLS `R')  `instruct' replace
. 
.         xi: reg    Dl_aadt l_aadt Dl_pop i.year, cl(msa) robust  
.         outreg2    l_aadt  Dl_pop using revision/table7.xls,ctitle(OLS `R')  `instruct' append
. 
.         xi: reg    Dl_aadt l_aadt Dl_pop  `geography' `census_div' i.year, cl(msa) robust  
.         outreg2    l_aadt  Dl_pop using revision/table7.xls,ctitle(OLS `R')  `instruct' append
. 
.         xi: reg    Dl_aadt l_aadt Dl_pop  `geography' `census_div' `population' `demographics' i.year, cl(msa) robust  
.         outreg2    l_aadt  Dl_pop using revision/table7.xls,ctitle(OLS `R')  `instruct' append
. 
.         xi: xtreg  Dl_aadt l_aadt i.year, fe robust  
.         outreg2    l_aadt using revision/table7.xls,ctitle(FE `R')  `instruct' append
. 
.         xi: ivreg2 Dl_aadt l_aadt  (Dl_pop =g_exp) S_manuf i.year `geography' `census_div', cl(msa) robust  
.         outreg2    l_aadt Dl_pop using revision/table7.xls,ctitle(IV `R')  `instruct2' append
. 
. 
.         log close
.         }
r(198);

end of do-file

r(198);

. do "C:\Users\chris\AppData\Local\Temp\STD775c_000000.tmp"

. if 1==1{
. quietly log using revision/table7, text replace
log file already open
r(604);
. 
. use $data, clear
. 
.         * Generate non urbanised area variables
.         gen l_ln_km_IHNU_83  = ln(ln_km_IH_83 - ln_km_IHU_83)
.         gen l_rd_km_IHNU_83  = ln(rd_km_IH_83 - rd_km_IHU_83)
.         gen l_vmt_IHNU_83 = ln(vmt_IH_83 - vmt_IHU_83)
.         gen l_aadt_IHNU_83 = l_vmt_IHNU_83 - l_rd_km_IHNU_83 
.         gen l_ln_km_IHNU_93  = ln(ln_km_IH_93 - ln_km_IHU_93)
.         gen l_rd_km_IHNU_93  = ln(rd_km_IH_93 - rd_km_IHU_93)
.         gen l_vmt_IHNU_93 = ln(vmt_IH_93 - vmt_IHU_93)
.         gen l_aadt_IHNU_93 = l_vmt_IHNU_93 - l_rd_km_IHNU_93 
.         gen l_ln_km_IHNU_03  = ln(ln_km_IH_03 - ln_km_IHU_03)
.         gen l_rd_km_IHNU_03  = ln(rd_km_IH_03 - rd_km_IHU_03)
.         gen l_vmt_IHNU_03 = ln(vmt_IH_03 - vmt_IHU_03)
.         gen l_aadt_IHNU_03 = l_vmt_IHNU_03 - l_rd_km_IHNU_03 
. 
.         * Selection of observations
.         drop if l_ln_km_IH_83==0
.         gen zero = min(l_ln_km_IH_83,l_ln_km_IH_93,l_ln_km_IHU_83,l_ln_km_IHU_93,l_ln_km_MRU_83,l_ln_km_MRU_93,l_ln_km_IHNU_83,l_ln_km_IHNU
> _93)
. 
.         rename sprawl_1992 sprawl_2003
.         rename sprawl_1976 sprawl_1993
. 
.         *rescale so display is better
.         replace elevat_range_msa = elevat_range_msa/1000 
.         replace ruggedness_msa = ruggedness_msa/1000
.         replace heating_dd = heating_dd/100
.         replace cooling_dd = cooling_dd/100
. 
.         *Generate first differences
.         gen  Dl_ln_IH_1993 = l_ln_km_IH_93 - l_ln_km_IH_83
.         gen  Dl_ln_IH_2003 = l_ln_km_IH_03 - l_ln_km_IH_93
.         gen  Dl_vmt_IH_1993 = l_vmt_IH_93 - l_vmt_IH_83 
.         gen  Dl_vmt_IH_2003 = l_vmt_IH_03 - l_vmt_IH_93 
.         gen  Dl_aadt_IH_1993 = l_aadt_IH_93 - l_aadt_IH_83 
.         gen  Dl_aadt_IH_2003 = l_aadt_IH_03 - l_aadt_IH_93 
. 
. 
.         gen Dl_pop_1993 = l_pop90 -l_pop80
.         gen Dl_pop_2003 = l_pop00 -l_pop90
. 
.       gen l_pop_1983 = l_pop80 
.       gen l_pop_1993 = l_pop90 
.       gen l_pop_2003 = l_pop00 
.      
.         gen g_exp_2003=g_exp00_90
.         gen g_exp_1993=g_exp90_80
. 
.       rename l_aadt_IH_83 l_aadt_IH_1993
.       rename l_aadt_IH_93 l_aadt_IH_2003
.  
.         rename S_somecollege_80 S_somecollege_1993 
.         rename l_mean_income_80 l_mean_income_1993 
.         rename S_poor_80 S_poor_1993 
.         rename S_manuf83 S_manuf_1993 
.  
.         rename S_somecollege_90 S_somecollege_2003 
.         rename l_mean_income_90 l_mean_income_2003 
.         rename S_poor_90 S_poor_2003 
.         rename S_manuf93 S_manuf_2003 
. 
.         reshape long Dl_ln_IH Dl_aadt_IH l_aadt_IH 
.                  sprawl S_somecollege l_mean_income S_poor S_manuf g_exp
.                          Dl_pop l_pop, i(msa ) j(year _1993 _2003)
. 
.         local geography  "elevat_range_msa ruggedness_msa heating_dd cooling_dd sprawl"
.         local demographics  "S_somecollege l_mean_income seg1980_ghetto S_poor S_manuf"  
.         local population "l_pop80 l_pop70 l_pop60 l_pop50 l_pop40 l_pop30 l_pop20"  
.         local census_div "div1 div2 div3 div4 div5 div6 div7 div8 div9"
. 
.         *instructions for outreg
.         local instruct "tex tdec(2) rdec(2) auto(2) symbol($^a$,$^b$,$^c$) se " 
.         local instruct2 "tex tdec(2) rdec(2) auto(2) symbol($^a$,$^b$,$^c$) se addstat(Overid, e(widstat))" 
. 
.         iis msa
. 
.         local R "IH"
. 
.         capture drop Dl_aadt Dl_ln l_aadt 
.         gen Dl_aadt = Dl_aadt_`R' 
.         gen Dl_ln  = Dl_ln_`R' 
.         gen l_aadt = l_aadt_`R' 
. 
.         xi: reg    Dl_aadt l_aadt i.year, cl(msa) robust  
.         outreg2    l_aadt using revision/table7.xls,ctitle(OLS `R')  `instruct' replace
. 
.         xi: reg    Dl_aadt l_aadt Dl_pop i.year, cl(msa) robust  
.         outreg2    l_aadt  Dl_pop using revision/table7.xls,ctitle(OLS `R')  `instruct' append
. 
.         xi: reg    Dl_aadt l_aadt Dl_pop  `geography' `census_div' i.year, cl(msa) robust  
.         outreg2    l_aadt  Dl_pop using revision/table7.xls,ctitle(OLS `R')  `instruct' append
. 
.         xi: reg    Dl_aadt l_aadt Dl_pop  `geography' `census_div' `population' `demographics' i.year, cl(msa) robust  
.         outreg2    l_aadt  Dl_pop using revision/table7.xls,ctitle(OLS `R')  `instruct' append
. 
.         xi: xtreg  Dl_aadt l_aadt i.year, fe robust  
.         outreg2    l_aadt using revision/table7.xls,ctitle(FE `R')  `instruct' append
. 
.         xi: ivreg2 Dl_aadt l_aadt  (Dl_pop =g_exp) S_manuf i.year `geography' `census_div', cl(msa) robust  
.         outreg2    l_aadt Dl_pop using revision/table7.xls,ctitle(IV `R')  `instruct2' append
. 
. 
.         log close
.         }
r(604);

end of do-file

r(604);

